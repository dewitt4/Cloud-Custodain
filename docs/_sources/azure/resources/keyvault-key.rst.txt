.. _azure.keyvault-key:

azure.keyvault-key
==================

Key Vault Key Resource

:example:

This policy will find all Keys in `keyvault_test` and `keyvault_prod` KeyVaults

.. code-block:: yaml

    policies:
      - name: keyvault-keys
        description:
          List all keys from 'keyvault_test' and 'keyvault_prod' vaults
        resource: azure.keyvault-key
        filters:
          - type: keyvault
            vaults:
              - keyvault_test
              - keyvault_prod

:example:

This policy will find all Keys in all KeyVaults that are older than 30 days

.. code-block:: yaml

    policies:
      - name: keyvault-keys
        description:
          List all keys that are older than 30 days
        resource: azure.keyvault-key
        filters:
          - type: value
            key: attributes.created
            value_type: age
            op: gt
            value: 30

:example:

If your company wants to enforce usage of HSM-backed keys in the KeyVaults,
you can use this policy to find all Keys in all KeyVaults not backed by an HSM module.

.. code-block:: yaml

    policies:
      - name: keyvault-keys
        description:
          List all non-HSM keys
        resource: azure.keyvault-key
        filters:
          - not:
             - type: key-type
               key-types:
                 - RSA-HSM, EC-HSM

Filters
-------


  - :ref:`event <azure.common.filters.event>`
  
  - :ref:`key-type <azure.keyvault-key.filters.key-type>`

  - :ref:`keyvault <azure.keyvault-key.filters.keyvault>`

  - :ref:`parent <azure.common.filters.parent>`
  
  - :ref:`value <azure.common.filters.value>`
  


.. _azure.keyvault-key.filters.key-type:

key-type
++++++++


.. container:: toggle

  

  .. raw:: html
     
    <div class="header docutils container" style=""></div>

  .. code-block:: yaml

    properties:
      key-types:
        items:
          enum:
          - EC
          - EC-HSM
          - RSA
          - RSA-HSM
        type: array
      type:
        enum:
        - key-type
    required:
    - type


.. _azure.keyvault-key.filters.keyvault:

keyvault
++++++++


.. container:: toggle

  

  .. raw:: html
     
    <div class="header docutils container" style=""></div>

  .. code-block:: yaml

    properties:
      type:
        enum:
        - keyvault
      vaults:
        items:
          type: string
        type: array
    required:
    - vaults
    - type




Actions
-------


  - :ref:`logic-app <azure.common.actions.logic-app>`
  
  - :ref:`notify <azure.common.actions.notify>`
  
  - :ref:`webhook <azure.common.actions.webhook>`
  


