

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Access Control &mdash; Cloud Custodian  documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/c1_labs.ico"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/expand.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="App Service Plan" href="appserviceplan.html" />
    <link rel="prev" title="Generic Filters" href="../genericarmfilter.html" /> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> Cloud Custodian
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart/usage.html">Monitoring your environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart/advanced.html">Advanced Usage</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart/offhours.html">Example offhours policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart/tagCompliance.html">Example tag compliance policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usecases/index.html">Use Cases</a></li>
</ul>
<p class="caption"><span class="caption-text">Working with AWS Lambda</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../policy/lambda.html">Lambda Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../policy/mu.html">Mu - Lambda Lifecycle Management</a></li>
</ul>
<p class="caption"><span class="caption-text">Policies reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../policy/index.html">Resource-Specific Filters and Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../filters.html">Generic Filters</a></li>
</ul>
<p class="caption"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../contribute.html">Contributing to Cloud Custodian</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developer/index.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developer/installing.html">Installing for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developer/tests.html">Testing for Developers</a></li>
</ul>
<p class="caption"><span class="caption-text">Azure</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../authentication.html">Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Policies</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../genericarmaction.html">Generic Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../genericarmfilter.html">Generic Filters</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Access Control</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#filters">Filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#actions">Actions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-policies">Example Policies</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="appserviceplan.html">App Service Plan</a></li>
<li class="toctree-l2"><a class="reference internal" href="arm.html">Network Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="batch.html">Batch</a></li>
<li class="toctree-l2"><a class="reference internal" href="cdn.html">CDN</a></li>
<li class="toctree-l2"><a class="reference internal" href="cognitiveservices.html">Cognitive Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="containerservice.html">Container Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="cosmosdb.html">Cosmos DB</a></li>
<li class="toctree-l2"><a class="reference internal" href="datafactory.html">Data Factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="datalake.html">Data Lake</a></li>
<li class="toctree-l2"><a class="reference internal" href="disk.html">Disk</a></li>
<li class="toctree-l2"><a class="reference internal" href="iothub.html">IoT Hub</a></li>
<li class="toctree-l2"><a class="reference internal" href="keyvault.html">Key Vault</a></li>
<li class="toctree-l2"><a class="reference internal" href="loadbalancer.html">Load Balancer</a></li>
<li class="toctree-l2"><a class="reference internal" href="networkinterface.html">Network Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="nsg.html">Network Security Groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="policyassignments.html">Policy assignments</a></li>
<li class="toctree-l2"><a class="reference internal" href="publicip.html">Public IP Address</a></li>
<li class="toctree-l2"><a class="reference internal" href="redis.html">Redis</a></li>
<li class="toctree-l2"><a class="reference internal" href="resourcegroup.html">Resource Groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="sqlserver.html">SQl Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="storage.html">Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="subscription.html">Subscription</a></li>
<li class="toctree-l2"><a class="reference internal" href="vm.html">Virtual Machines</a></li>
<li class="toctree-l2"><a class="reference internal" href="vmss.html">Virtual Machine Scale Set</a></li>
<li class="toctree-l2"><a class="reference internal" href="vnet.html">Virtual Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="webapp.html">Web Applications</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced/index.html">Advanced Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute.html">Developer Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../generated/aws/modules.html">AWS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../generated/azure/modules.html">Azure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../generated/gcp/modules.html">GCP</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Cloud Custodian</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Policies</a> &raquo;</li>
        
      <li>Access Control</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="access-control">
<span id="azure-access-control"></span><h1>Access Control<a class="headerlink" href="#access-control" title="Permalink to this headline">¶</a></h1>
<p>Cloud custodian supports both azure role assignments and role definitions.</p>
<p>In order to get the principal name, display name, and AAD type (User, Service Principal, etc) of role assignments the
method of authorization must have the necessary permissions to read from the Microsoft AAD Graph. For Service Principal
Authorization the Service Principal must have the permissions to <cite>read all users’ full profiles</cite>. Azure CLI
authentication will provide the necessary permissions to run the policy locally. Basic token authentication will not
provide the necessary permissions.</p>
<div class="section" id="filters">
<h2>Filters<a class="headerlink" href="#filters" title="Permalink to this headline">¶</a></h2>
<ul>
<li><dl class="first docutils">
<dt>Standard Value Filter (see <a class="reference internal" href="../../../filters.html#filters"><span class="std std-ref">Generic Filters</span></a>)</dt>
<dd><ul class="first last simple">
<li>Model: <a class="reference external" href="https://docs.microsoft.com/en-us/python/api/azure.mgmt.authorization.models.roleassignment?view=azure-python">RoleAssignment</a></li>
<li>Model: <a class="reference external" href="https://docs.microsoft.com/en-us/python/api/azure.mgmt.authorization.models.roledefinition?view=azure-python">RoleDefinition</a></li>
</ul>
</dd>
</dl>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">role</span></code>
Filters Role Assignments based on name of Role Definition</p>
<div class="toggle docutils container">
<div class="header docutils container">
<p>Schema:</p>
</div>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;default&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;object&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;key&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;op&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;enum&quot;</span><span class="o">:</span> <span class="p">[</span>
      <span class="s2">&quot;equal&quot;</span><span class="p">,</span>
      <span class="s2">&quot;eq&quot;</span><span class="p">,</span>
      <span class="s2">&quot;difference&quot;</span><span class="p">,</span>
      <span class="s2">&quot;glob&quot;</span><span class="p">,</span>
      <span class="s2">&quot;ne&quot;</span><span class="p">,</span>
      <span class="s2">&quot;less-than&quot;</span><span class="p">,</span>
      <span class="s2">&quot;gt&quot;</span><span class="p">,</span>
      <span class="s2">&quot;not-in&quot;</span><span class="p">,</span>
      <span class="s2">&quot;ni&quot;</span><span class="p">,</span>
      <span class="s2">&quot;not-equal&quot;</span><span class="p">,</span>
      <span class="s2">&quot;lt&quot;</span><span class="p">,</span>
      <span class="s2">&quot;intersect&quot;</span><span class="p">,</span>
      <span class="s2">&quot;gte&quot;</span><span class="p">,</span>
      <span class="s2">&quot;lte&quot;</span><span class="p">,</span>
      <span class="s2">&quot;regex&quot;</span><span class="p">,</span>
      <span class="s2">&quot;ge&quot;</span><span class="p">,</span>
      <span class="s2">&quot;in&quot;</span><span class="p">,</span>
      <span class="s2">&quot;greater-than&quot;</span><span class="p">,</span>
      <span class="s2">&quot;le&quot;</span><span class="p">,</span>
      <span class="s2">&quot;contains&quot;</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;oneOf&quot;</span><span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;array&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;boolean&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;number&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;null&quot;</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="s2">&quot;value_from&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;additionalProperties&quot;</span><span class="o">:</span> <span class="s2">&quot;False&quot;</span><span class="p">,</span>
    <span class="s2">&quot;properties&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;expr&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;oneOf&quot;</span><span class="o">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;integer&quot;</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span>
          <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">},</span>
      <span class="s2">&quot;format&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;enum&quot;</span><span class="o">:</span> <span class="p">[</span>
          <span class="s2">&quot;csv&quot;</span><span class="p">,</span>
          <span class="s2">&quot;json&quot;</span><span class="p">,</span>
          <span class="s2">&quot;txt&quot;</span><span class="p">,</span>
          <span class="s2">&quot;csv2dict&quot;</span>
        <span class="p">]</span>
      <span class="p">},</span>
      <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;required&quot;</span><span class="o">:</span> <span class="p">[</span>
      <span class="s2">&quot;url&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;object&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;value_type&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;enum&quot;</span><span class="o">:</span> <span class="p">[</span>
      <span class="s2">&quot;age&quot;</span><span class="p">,</span>
      <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
      <span class="s2">&quot;expiration&quot;</span><span class="p">,</span>
      <span class="s2">&quot;normalize&quot;</span><span class="p">,</span>
      <span class="s2">&quot;size&quot;</span><span class="p">,</span>
      <span class="s2">&quot;cidr&quot;</span><span class="p">,</span>
      <span class="s2">&quot;cidr_size&quot;</span><span class="p">,</span>
      <span class="s2">&quot;swap&quot;</span><span class="p">,</span>
      <span class="s2">&quot;resource_count&quot;</span><span class="p">,</span>
      <span class="s2">&quot;expr&quot;</span><span class="p">,</span>
      <span class="s2">&quot;unique_size&quot;</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">resource-access</span></code>
Filter Role Assignments based on access to an azure resource</p>
<div class="toggle docutils container">
<div class="header docutils container">
<p>Schema:</p>
</div>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;default&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;object&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;key&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;op&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;enum&quot;</span><span class="o">:</span> <span class="p">[</span>
      <span class="s2">&quot;equal&quot;</span><span class="p">,</span>
      <span class="s2">&quot;eq&quot;</span><span class="p">,</span>
      <span class="s2">&quot;difference&quot;</span><span class="p">,</span>
      <span class="s2">&quot;glob&quot;</span><span class="p">,</span>
      <span class="s2">&quot;ne&quot;</span><span class="p">,</span>
      <span class="s2">&quot;less-than&quot;</span><span class="p">,</span>
      <span class="s2">&quot;gt&quot;</span><span class="p">,</span>
      <span class="s2">&quot;not-in&quot;</span><span class="p">,</span>
      <span class="s2">&quot;ni&quot;</span><span class="p">,</span>
      <span class="s2">&quot;not-equal&quot;</span><span class="p">,</span>
      <span class="s2">&quot;lt&quot;</span><span class="p">,</span>
      <span class="s2">&quot;intersect&quot;</span><span class="p">,</span>
      <span class="s2">&quot;gte&quot;</span><span class="p">,</span>
      <span class="s2">&quot;lte&quot;</span><span class="p">,</span>
      <span class="s2">&quot;regex&quot;</span><span class="p">,</span>
      <span class="s2">&quot;ge&quot;</span><span class="p">,</span>
      <span class="s2">&quot;in&quot;</span><span class="p">,</span>
      <span class="s2">&quot;greater-than&quot;</span><span class="p">,</span>
      <span class="s2">&quot;le&quot;</span><span class="p">,</span>
      <span class="s2">&quot;contains&quot;</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="s2">&quot;relatedResource&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;required&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;oneOf&quot;</span><span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;array&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;boolean&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;number&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;null&quot;</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="s2">&quot;value_from&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;additionalProperties&quot;</span><span class="o">:</span> <span class="s2">&quot;False&quot;</span><span class="p">,</span>
    <span class="s2">&quot;properties&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;expr&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;oneOf&quot;</span><span class="o">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;integer&quot;</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span>
          <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">},</span>
      <span class="s2">&quot;format&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;enum&quot;</span><span class="o">:</span> <span class="p">[</span>
          <span class="s2">&quot;csv&quot;</span><span class="p">,</span>
          <span class="s2">&quot;json&quot;</span><span class="p">,</span>
          <span class="s2">&quot;txt&quot;</span><span class="p">,</span>
          <span class="s2">&quot;csv2dict&quot;</span>
        <span class="p">]</span>
      <span class="p">},</span>
      <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;required&quot;</span><span class="o">:</span> <span class="p">[</span>
      <span class="s2">&quot;url&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;object&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;value_type&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;enum&quot;</span><span class="o">:</span> <span class="p">[</span>
      <span class="s2">&quot;age&quot;</span><span class="p">,</span>
      <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
      <span class="s2">&quot;expiration&quot;</span><span class="p">,</span>
      <span class="s2">&quot;normalize&quot;</span><span class="p">,</span>
      <span class="s2">&quot;size&quot;</span><span class="p">,</span>
      <span class="s2">&quot;cidr&quot;</span><span class="p">,</span>
      <span class="s2">&quot;cidr_size&quot;</span><span class="p">,</span>
      <span class="s2">&quot;swap&quot;</span><span class="p">,</span>
      <span class="s2">&quot;resource_count&quot;</span><span class="p">,</span>
      <span class="s2">&quot;expr&quot;</span><span class="p">,</span>
      <span class="s2">&quot;unique_size&quot;</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">scope</span></code>
Filter Role Assignments by scope access</p>
<div class="toggle docutils container">
<div class="header docutils container">
<p>Schema:</p>
</div>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;value&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;enum&quot;</span><span class="o">:</span> <span class="p">[</span>
      <span class="s2">&quot;subscription&quot;</span><span class="p">,</span>
      <span class="s2">&quot;resource-group&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</li>
</ul>
</div>
<div class="section" id="actions">
<h2>Actions<a class="headerlink" href="#actions" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>ARM Resource Actions (see <a class="reference internal" href="../genericarmaction.html#azure-genericarmaction"><span class="std std-ref">Generic Actions</span></a>)</li>
<li><code class="docutils literal notranslate"><span class="pre">delete</span></code>
Deletes role assignment</li>
</ul>
</div>
<div class="section" id="example-policies">
<h2>Example Policies<a class="headerlink" href="#example-policies" title="Permalink to this headline">¶</a></h2>
<p>Return role assignments with the Owner role.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">policies</span><span class="p p-Indicator">:</span>
   <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">assignment-by-role</span>
     <span class="l l-Scalar l-Scalar-Plain">resource</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">azure.roleassignment</span>
     <span class="l l-Scalar l-Scalar-Plain">filters</span><span class="p p-Indicator">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">role</span>
          <span class="l l-Scalar l-Scalar-Plain">key</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">properties.roleName</span>
          <span class="l l-Scalar l-Scalar-Plain">op</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">eq</span>
          <span class="l l-Scalar l-Scalar-Plain">value</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Owner</span>
</pre></div>
</div>
<p>Return all assignments with the Owner role that have access to virtual machines. For the
resource-access filter, the related resource can be any custodian supported azure resource other than
azure.roleassignments or azure.roledefinitions.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">policies</span><span class="p p-Indicator">:</span>
   <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">assignment-by-role-and-resource</span>
     <span class="l l-Scalar l-Scalar-Plain">resource</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">azure.roleassignment</span>
     <span class="l l-Scalar l-Scalar-Plain">filters</span><span class="p p-Indicator">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">role</span>
          <span class="l l-Scalar l-Scalar-Plain">key</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">properties.roleName</span>
          <span class="l l-Scalar l-Scalar-Plain">op</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">eq</span>
          <span class="l l-Scalar l-Scalar-Plain">value</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Owner</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">resource-access</span>
          <span class="l l-Scalar l-Scalar-Plain">relatedResource</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">azure.vm</span>
</pre></div>
</div>
<p>Return all assignments with the Owner role that have access to virtual machines in westus2:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">policies</span><span class="p p-Indicator">:</span>
   <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">assignment-by-role-and-resource</span>
     <span class="l l-Scalar l-Scalar-Plain">resource</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">azure.roleassignment</span>
     <span class="l l-Scalar l-Scalar-Plain">filters</span><span class="p p-Indicator">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">role</span>
          <span class="l l-Scalar l-Scalar-Plain">key</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">properties.roleName</span>
          <span class="l l-Scalar l-Scalar-Plain">op</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">eq</span>
          <span class="l l-Scalar l-Scalar-Plain">value</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Owner</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">resource-access</span>
          <span class="l l-Scalar l-Scalar-Plain">relatedResource</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">azure.vm</span>
          <span class="l l-Scalar l-Scalar-Plain">key</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">location</span>
          <span class="l l-Scalar l-Scalar-Plain">op</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">eq</span>
          <span class="l l-Scalar l-Scalar-Plain">value</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">westus2</span>
</pre></div>
</div>
<p>Return assignments with the principal name <a class="reference external" href="mailto:custodian&#37;&#52;&#48;example&#46;com">custodian<span>&#64;</span>example<span>&#46;</span>com</a>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">policies</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">assignment-by-principal-name</span>
    <span class="l l-Scalar l-Scalar-Plain">resource</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">azure.roleassignment</span>
    <span class="l l-Scalar l-Scalar-Plain">filters</span><span class="p p-Indicator">:</span>
       <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">value</span>
         <span class="l l-Scalar l-Scalar-Plain">key</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">principalName</span>
         <span class="l l-Scalar l-Scalar-Plain">op</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">eq</span>
         <span class="l l-Scalar l-Scalar-Plain">value</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">custodian@example.com</span>
</pre></div>
</div>
<p>Return role definitions that explicitly have the permission to read authorization objects (role
assignments, role definitions, etc). If a role definition inherits permissions (e.g. by having * permissions)
they are not returned in this filter.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">policies</span><span class="p p-Indicator">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">role-definition-permissions</span>
      <span class="l l-Scalar l-Scalar-Plain">resource</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">azure.roledefinition</span>
      <span class="l l-Scalar l-Scalar-Plain">filters</span><span class="p p-Indicator">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">value</span>
          <span class="l l-Scalar l-Scalar-Plain">key</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">properties.permissions[0].actions</span>
          <span class="l l-Scalar l-Scalar-Plain">value</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Microsoft.Authorization/*/read</span>
          <span class="l l-Scalar l-Scalar-Plain">op</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">contains</span>
</pre></div>
</div>
<p>Delete the assignment with principal name <a class="reference external" href="mailto:custodian&#37;&#52;&#48;example&#46;com">custodian<span>&#64;</span>example<span>&#46;</span>com</a>. The permissions required to run the
delete action requires delete permissions to Microsoft.Authorization. The built-in role with the necessary permissions
is Owner.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">policies</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">delete-assignment-by-principal-name</span>
    <span class="l l-Scalar l-Scalar-Plain">resource</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">azure.roleassignment</span>
    <span class="l l-Scalar l-Scalar-Plain">filters</span><span class="p p-Indicator">:</span>
       <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">value</span>
         <span class="l l-Scalar l-Scalar-Plain">key</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">principalName</span>
         <span class="l l-Scalar l-Scalar-Plain">op</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">eq</span>
         <span class="l l-Scalar l-Scalar-Plain">value</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">custodian@example.com</span>
    <span class="l l-Scalar l-Scalar-Plain">actions</span><span class="p p-Indicator">:</span>
       <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">delete</span>
</pre></div>
</div>
<p>Return all role assignments with the Subscription level scope access.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">policies</span><span class="p p-Indicator">:</span>
   <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">assignments-subscription-scope</span>
     <span class="l l-Scalar l-Scalar-Plain">resource</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">azure.roleassignment</span>
     <span class="l l-Scalar l-Scalar-Plain">filters</span><span class="p p-Indicator">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">scope</span>
          <span class="l l-Scalar l-Scalar-Plain">value</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">subscription</span>
</pre></div>
</div>
<p>Return all role assignments with the Resource Group level scope access.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">policies</span><span class="p p-Indicator">:</span>
   <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">assignments-resource-group-scope</span>
     <span class="l l-Scalar l-Scalar-Plain">resource</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">azure.roleassignment</span>
     <span class="l l-Scalar l-Scalar-Plain">filters</span><span class="p p-Indicator">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">scope</span>
          <span class="l l-Scalar l-Scalar-Plain">value</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">resource-group</span>
</pre></div>
</div>
<p>Return all role assignments with scope level access other than Subscription or Resource Group.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">policies</span><span class="p p-Indicator">:</span>
   <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">assignments-other-level-scope</span>
     <span class="l l-Scalar l-Scalar-Plain">resource</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">azure.roleassignment</span>
     <span class="l l-Scalar l-Scalar-Plain">filters</span><span class="p p-Indicator">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not</span><span class="p p-Indicator">:</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">scope</span>
            <span class="l l-Scalar l-Scalar-Plain">value</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">subscription</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">not</span><span class="p p-Indicator">:</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">scope</span>
            <span class="l l-Scalar l-Scalar-Plain">value</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">resource-group</span>
</pre></div>
</div>
<p>Return all service principal role assignments with the Subscription level scope access.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">policies</span><span class="p p-Indicator">:</span>
   <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">service-principal-assignments-subscription-scope</span>
     <span class="l l-Scalar l-Scalar-Plain">resource</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">azure.roleassignment</span>
     <span class="l l-Scalar l-Scalar-Plain">filters</span><span class="p p-Indicator">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">value</span>
          <span class="l l-Scalar l-Scalar-Plain">key</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">aadType</span>
          <span class="l l-Scalar l-Scalar-Plain">op</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">eq</span>
          <span class="l l-Scalar l-Scalar-Plain">value</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ServicePrincipal</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">scope</span>
          <span class="l l-Scalar l-Scalar-Plain">value</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">subscription</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="appserviceplan.html" class="btn btn-neutral float-right" title="App Service Plan" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../genericarmfilter.html" class="btn btn-neutral" title="Generic Filters" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Capital One Services, LLC.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../../_static/js/expand.js"></script>

  

  <script type="text/javascript" src="../../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>